[{"FileName": "before.c", "Caller": "init_entity_runnable_average", "Source": false, "Sink": false, "idx": 0, "CWE-ID": "CWE-", "category": "CallExpression", "criterion": "memset", "line": 703, "label": -3, "slices": ["void init_entity_runnable_average(struct sched_entity *se)\n", "\tstruct sched_avg *sa = &se->avg;\n", "\tmemset(sa, 0, sizeof(*sa));\n", "\tif (entity_is_task(se))\n", "\t\tsa->runnable_load_avg = sa->load_avg = scale_load_down(se->load.weight);\n"]}, {"FileName": "before.c", "Caller": "update_numa_stats", "Source": false, "Sink": false, "idx": 1, "CWE-ID": "CWE-", "category": "CallExpression", "criterion": "memset", "line": 1476, "label": -3, "slices": ["static void update_numa_stats(struct numa_stats *ns, int nid)\n", "\tint cpu;\n", "\tmemset(ns, 0, sizeof(*ns));\n", "\t\tstruct rq *rq = cpu_rq(cpu);\n", "\t\tns->load += weighted_cpuload(rq);\n", "\t\tns->compute_capacity += capacity_of(cpu);\n"]}, {"FileName": "before.c", "Caller": "update_task_scan_period", "Source": false, "Sink": false, "idx": 2, "CWE-ID": "CWE-", "category": "CallExpression", "criterion": "memset", "line": 1978, "label": -3, "slices": ["static void update_task_scan_period(struct task_struct *p,\n\t\t\tunsigned long shared, unsigned long private)\n", "\t\t\tunsigned long shared, unsigned long private)\n", "\tunsigned int period_slot;\n", "\tint lr_ratio, ps_ratio;\n", "\tint diff;\n", "\tunsigned long remote = p->numa_faults_locality[0];\n", "\tunsigned long local = p->numa_faults_locality[1];\n", "\tif (local + shared == 0 || p->numa_faults_locality[2]) {\n", "\t\tp->numa_scan_period = min(p->numa_scan_period_max,\n\t\t\tp->numa_scan_period << 1);\n", "\t\tp->mm->numa_next_scan = jiffies +\n", "\tperiod_slot = DIV_ROUND_UP(p->numa_scan_period, NUMA_PERIOD_SLOTS);\n", "\tlr_ratio = (local * NUMA_PERIOD_SLOTS) / (local + remote);\n", "\tps_ratio = (private * NUMA_PERIOD_SLOTS) / (private + shared);\n", "\tif (ps_ratio >= NUMA_PERIOD_THRESHOLD) {\n", "\t\tint slot = ps_ratio - NUMA_PERIOD_THRESHOLD;\n", "\t\tif (!slot)\n", "\t\t\tslot = 1;\n", "else\n", "\t} else if (lr_ratio >= NUMA_PERIOD_THRESHOLD) {\n", "\t\tint slot = lr_ratio - NUMA_PERIOD_THRESHOLD;\n", "\t\tif (!slot)\n", "\t\t\tslot = 1;\n", "\t\tdiff = slot * period_slot;\n", "else\n", "\t\tint ratio = max(lr_ratio, ps_ratio);\n", "\t\tdiff = -(NUMA_PERIOD_THRESHOLD - ratio) * period_slot;\n", "\tp->numa_scan_period = clamp(p->numa_scan_period + diff,\n\t\t\ttask_scan_min(p), task_scan_max(p));\n", "\tmemset(p->numa_faults_locality, 0, sizeof(p->numa_faults_locality));\n"]}, {"FileName": "before.c", "Caller": "task_numa_fault", "Source": false, "Sink": false, "idx": 3, "CWE-ID": "CWE-", "category": "CallExpression", "criterion": "memset", "line": 2375, "label": -3, "slices": ["\tstruct task_struct *p = current;\n", "\tbool migrated = flags & TNF_MIGRATED;\n", "\tint cpu_node = task_node(current);\n", "\tint local = !!(flags & TNF_FAULT_LOCAL);\n", "\tstruct numa_group *ng;\n", "\tint priv;\n", "\tif (!static_branch_likely(&sched_numa_balancing))\n", "\tif (!p->mm)\n", "\tif (unlikely(!p->numa_faults)) {\n", "\t\tint size = sizeof(*p->numa_faults) *\n", "\t\tp->numa_faults = kzalloc(size, GFP_KERNEL|__GFP_NOWARN);\n", "\t\tif (!p->numa_faults)\n", "\t\tp->total_numa_faults = 0;\n", "\t\tmemset(p->numa_faults_locality, 0, sizeof(p->numa_faults_locality));\n", "\tif (unlikely(last_cpupid == (-1 & LAST_CPUPID_MASK))) {\n", "else\n", "\t\tpriv = cpupid_match_pid(p, last_cpupid);\n", "\t\tif (!priv && !(flags & TNF_NO_GROUP))\n", "\t\t\ttask_numa_group(p, last_cpupid, flags, &priv);\n", "\tng = p->numa_group;\n", "\tif (time_after(jiffies, p->numa_migrate_retry)) {\n", "\t\ttask_numa_placement(p);\n", "\t\tnuma_migrate_preferred(p);\n", "\tif (migrated)\n", "\t\tp->numa_pages_migrated += pages;\n", "\tif (flags & TNF_MIGRATE_FAIL)\n", "\t\tp->numa_faults_locality[2] += pages;\n", "\tp->numa_faults[task_faults_idx(NUMA_MEMBUF, mem_node, priv)] += pages;\n", "\tp->numa_faults[task_faults_idx(NUMA_CPUBUF, cpu_node, priv)] += pages;\n", "\tp->numa_faults_locality[local] += pages;\n"]}, {"FileName": "before.c", "Caller": "update_sg_lb_stats", "Source": false, "Sink": false, "idx": 4, "CWE-ID": "CWE-", "category": "CallExpression", "criterion": "memset", "line": 8172, "label": -3, "slices": ["\t\t\t\t      struct sg_lb_stats *sgs,\n", "\tint local_group = cpumask_test_cpu(env->dst_cpu, sched_group_span(group));\n", "\tint load_idx = get_sd_load_idx(env->sd, env->idle);\n", "\tunsigned long load;\n", "\tint i, nr_running;\n", "\tmemset(sgs, 0, sizeof(*sgs));\n", "\t\tstruct rq *rq = cpu_rq(i);\n", "\t\tsgs->group_load += load;\n", "\t\tsgs->group_util += cpu_util(i);\n", "\t\tsgs->sum_nr_running += rq->cfs.h_nr_running;\n", "\t\tsgs->nr_numa_running += rq->nr_numa_running;\n", "\t\tsgs->nr_preferred_running += rq->nr_preferred_running;\n", "\t\tsgs->sum_weighted_load += weighted_cpuload(rq);\n", "\t\tif (!nr_running && idle_cpu(i))\n", "\t\t\tsgs->idle_cpus++;\n", "\t\tif (env->sd->flags & SD_ASYM_CPUCAPACITY &&\n\t\t    sgs->group_misfit_task_load < rq->misfit_task_load) {\n", "\t\t\tsgs->group_misfit_task_load = rq->misfit_task_load;\n", "\tsgs->group_capacity = group->sgc->capacity;\n", "\tsgs->avg_load = (sgs->group_load*SCHED_CAPACITY_SCALE) / sgs->group_capacity;\n", "\tif (sgs->sum_nr_running)\n", "\t\tsgs->load_per_task = sgs->sum_weighted_load / sgs->sum_nr_running;\n", "\tsgs->group_weight = group->group_weight;\n", "\tsgs->group_no_capacity = group_is_overloaded(env, sgs);\n", "\tsgs->group_type = group_classify(group, sgs);\n"]}]