# ğŸ“ SARD-fgets_for_loop_44

## ğŸ” ì·¨ì•½ì  ê°œìš”
* **ì·¨ì•½ì  ì¢…ë¥˜**: [CWE-400](https://cwe.mitre.org/data/definitions/400.html) Resource Exhaustion
* **Source**: `fgets()`ë¥¼ í†µí•œ ì‚¬ìš©ì ì…ë ¥
* **ì·¨ì•½ ì¡°ê±´**: ì‚¬ìš©ì ì…ë ¥ê°’ì— ëŒ€í•œ ê²€ì¦ ì—†ì´ ë°˜ë³µë¬¸ì˜ ë°˜ë³µ íšŸìˆ˜ë¡œ ì‚¬ìš©
* **Sink**: for ë£¨í”„ì—ì„œ ê²€ì¦ë˜ì§€ ì•Šì€ ì¹´ìš´íŠ¸ ê°’ ì‚¬ìš©

## íƒì§€ ê²°ê³¼ ìš”ì•½
* **ì´ ìŠ¬ë¼ì´ìŠ¤**: 4ê°œ
* **KSignSlicer ê²°ê³¼**:
  - ì·¨ì•½: 0ê°œ
  - ì •ìƒ: 4ê°œ
* **AI ëª¨ë¸ ê²°ê³¼**:
  - ì·¨ì•½: 0ê°œ
  - ì •ìƒ: 4ê°œ

### íƒì§€ ê²°ê³¼
| íŒŒì¼ëª… | í˜¸ì¶œ í•¨ìˆ˜ | Source | Sink | idx | CWE-ID | ì¹´í…Œê³ ë¦¬ | ê¸°ì¤€ | ë¼ì¸ | ë¼ë²¨ | í† í° ê¸¸ì´ | ì˜ˆì¸¡ |
|--------|-----------|---------|------|-----|---------|-----------|------|------|------|-----------|------|
| CWE400_Resource_Exhaustion__fgets_for_loop_44.c | CWE400_Resource_Exhaustion__fgets_for_loop_44_bad | False | True | 0 | CWE-400 | CallExpression | fgets | 46 | 0 | 48 | 0 |
| CWE400_Resource_Exhaustion__fgets_for_loop_44.c | CWE400_Resource_Exhaustion__fgets_for_loop_44_bad | False | True | 1 | CWE-400 | CallExpression | atoi | 49 | 0 | 56 | 0 |
| CWE400_Resource_Exhaustion__fgets_for_loop_44.c | goodB2G | False | True | 2 | CWE-400 | CallExpression | fgets | 113 | 0 | 48 | 0 |
| CWE400_Resource_Exhaustion__fgets_for_loop_44.c | goodB2G | False | True | 3 | CWE-400 | CallExpression | atoi | 116 | 0 | 56 | 0 |

## ì·¨ì•½ì  ì„¸ë¶€ ì‚¬í•­
### ğŸ“ ê´€ë ¨ íŒŒì¼ ì†Œê°œ
* `CWE400_Resource_Exhaustion__fgets_for_loop_44.c`: ë¦¬ì†ŒìŠ¤ ì†Œì§„ ì·¨ì•½ì ì„ í¬í•¨í•œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ íŒŒì¼

### â—ï¸ ì·¨ì•½ ì½”ë“œ
**ë¬¸ì œì **: ì‚¬ìš©ìë¡œë¶€í„° ì…ë ¥ë°›ì€ ê°’ì„ ê²€ì¦ ì—†ì´ ë°˜ë³µë¬¸ì˜ ë°˜ë³µ íšŸìˆ˜ë¡œ ì‚¬ìš©í•˜ì—¬ ë¦¬ì†ŒìŠ¤ ì†Œì§„ ì·¨ì•½ì  ë°œìƒ ê°€ëŠ¥

#### Source: `CWE400_Resource_Exhaustion__fgets_for_loop_44.c:46-49`
```c
/* ì·¨ì•½ì : fgets()ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìë¡œë¶€í„° ì§ì ‘ ì…ë ¥ì„ ë°›ìŒ */
if (fgets(inputBuffer, CHAR_ARRAY_SIZE, stdin) != NULL)
{
    /* ë¬¸ìì—´ì„ ì •ìˆ˜ë¡œ ë³€í™˜í•˜ì—¬ ë°˜ë³µ íšŸìˆ˜ë¡œ ì‚¬ìš© */
    count = atoi(inputBuffer);
}
```

#### Sink: `CWE400_Resource_Exhaustion__fgets_for_loop_44.c:24-27`
```c
/* ì·¨ì•½ì : ì‚¬ìš©ì ì…ë ¥ê°’ì„ ê²€ì¦ ì—†ì´ ë°˜ë³µë¬¸ì˜ ë°˜ë³µ íšŸìˆ˜ë¡œ ì‚¬ìš© */
for (i = 0; i < (size_t)count; i++)
{
    /* ë¦¬ì†ŒìŠ¤ë¥¼ ì†Œë¹„í•˜ëŠ” ì‘ì—… ìˆ˜í–‰ */
    printLine("Hello");
}
```

### âœ… ê°œì„  ì½”ë“œ
**ê°œì„  ë°©ë²• 1 - ì…ë ¥ê°’ ê²€ì¦**
**íŒ¨ì¹˜ ìœ„ì¹˜**: `CWE400_Resource_Exhaustion__fgets_for_loop_44.c:89-96`

```c
/* ê°œì„ ì‚¬í•­: ë°˜ë³µ íšŸìˆ˜ì— ëŒ€í•œ ìœ íš¨ì„± ê²€ì‚¬ ì¶”ê°€ */
if (count > 0 && count <= 20)
{
    /* ê²€ì¦ëœ ë²”ìœ„ ë‚´ì—ì„œë§Œ ë°˜ë³µë¬¸ ì‹¤í–‰ */
    for (i = 0; i < (size_t)count; i++)
    {
        printLine("Hello");
    }
}
```

**ê°œì„  ë°©ë²• 2 - ì•ˆì „í•œ ê¸°ë³¸ê°’ ì‚¬ìš©**
**íŒ¨ì¹˜ ìœ„ì¹˜**: `CWE400_Resource_Exhaustion__fgets_for_loop_44.c:77-86`

```c
/* ê°œì„ ì‚¬í•­: ì‚¬ìš©ì ì…ë ¥ ëŒ€ì‹  ì•ˆì „í•œ ê³ ì •ê°’ ì‚¬ìš© */
int count;
void (*funcPtr) (int) = goodG2BSink;
/* ì´ˆê¸°ê°’ ì„¤ì • */
count = -1;
/* ì•ˆì „í•œ ìƒìˆ˜ê°’ìœ¼ë¡œ ì„¤ì • */
count = 20;
funcPtr(count);
```

**ê°œì„  ë°©ë²•**:
* ë°©ë²• 1: ì…ë ¥ê°’ ê²€ì¦
  - ë°˜ë³µ íšŸìˆ˜ì— ëŒ€í•œ ìƒí•œê°’(20)ê³¼ í•˜í•œê°’(0) ì„¤ì •
  - ì…ë ¥ê°’ì´ ìœ íš¨ ë²”ìœ„ ë‚´ì— ìˆëŠ”ì§€ ê²€ì¦ í›„ ë°˜ë³µë¬¸ ì‹¤í–‰
  - ê²€ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ì ì…ë ¥ì„ ì§ì ‘ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ

* ë°©ë²• 2: ì•ˆì „í•œ ê¸°ë³¸ê°’ ì‚¬ìš©
  - ì‚¬ìš©ì ì…ë ¥ì„ ë°›ëŠ” ëŒ€ì‹  ì•ˆì „í•œ ê³ ì •ê°’ ì‚¬ìš©
  - ì»´íŒŒì¼ íƒ€ì„ì— ê²°ì •ë˜ëŠ” ìƒìˆ˜ê°’ í™œìš©
  - ì…ë ¥ ê²€ì¦ì´ í•„ìš” ì—†ëŠ” ì•ˆì „í•œ ì„¤ê³„ ì±„íƒ 